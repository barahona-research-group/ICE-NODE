#PBS -lselect=1:ncpus=8:mem=96gb

#PBS -lwalltime=0:30:0

#PBS -J 1-3

# Setup environement using .bashrc
source ~/.bashrc
conda activate mimic3-snonet

# Clone repository and checkout to the given tag name.
git clone git@github.com:A-Alaa/MIMIC-SNONET.git --branch $EXP_TAG exp-dec-07 --single-branch && cd MIMIC-SNONET

# Load modules for any applications

# Run program
$HOME/anaconda3/envs/mimic3-snonet/bin/python -m mimicnet.hpo-multi \
--output-dir ~/GP/ehr-data/mimic3-snonet-exp/$EXP_TAG \
--mimic-processed-dir ~/GP/ehr-data/mimic3-transforms \
--study-name $EXP_TAG \
--store-url $EXP_STORE_URL \
--cpu \
--num-trials 3 \
-N 8


mkdir $PBS_O_WORKDIR/$PBS_JOBID
cp * $PBS_O_WORKDIR/$PBS_JOBID
